<!-- c3025032-0c46-42bf-a579-f61e61ad8c94 ae692d09-0356-4000-8871-9223f68d04a8 -->
# CFBD Integration Hardening Plan

## Phase 0 – Unified Client & Foundational Hygiene

- **Step 1 – Client skeleton**: Create `src/cfbd_client/__init__.py` plus `client.py` with env-based auth (`CFBD_API_KEY`), host toggle via `CFBD_HOST` (`production` default, `next` optional), enforced 0.17 s throttle, and a single `get_games` endpoint; pause for review before adding retries.
- **Step 2 – Error handling & logging**: Extend `_request()` with structured stderr logging, retry/backoff (1/2/4 s), dedicated handling for 429 (log, wait 60 s, retry), 401/403 (fail fast), 5xx (retry), and other 4xx (surface request details); ensure zero coupling to existing agents.
- **Step 3 – Dataset helpers**: Implement `src/cfbd_client/datasets.py` functions (`fetch_games`, `fetch_ratings`, `fetch_lines`, `fetch_recruiting`) returning pandas DataFrames with normalized snake_case schemas, lowercase underscored teams, `fetched_at` timestamps, and validation for required columns.
- **Step 4 – Dependencies, tests, docs**: Update `requirements.txt`/`requirements-dev.txt` with pinned runtime + dev deps, add regression tests in `tests/test_cfbd_client.py` (responses-based mocks, throttling timing, host toggle, schema contracts), and publish `docs/CFBD_RUNBOOK.md` with quick start, troubleshooting, and escalation guidance.

## Phase 1 – Observability & Dataset Expansion

- Instrument telemetry dashboards for latency, status codes, retry counts, and dataset freshness; add alerting on rate-limit breaches and auth failures.
- Extend ingestion to additional CFBD datasets (weather, media, predicted points, recruiting aggregates) with schema alignment and automated naming checks.
- Automate schema diffing against CFBD docs and publish change logs in the repo.

## Phase 2 – GraphQL & Governance

- Introduce GraphQL client path (BoolExp/OrderBy support, optional subscriptions) once websocket infrastructure is ready and validated.
- Establish governance workflows: schema change approvals, agent onboarding checklist, incident run-books, documentation review cadence, and quarterly access reviews.
- Publish KPI dashboard tracking ingestion latency, API error rates, dataset coverage %, host parity, and MTTR.

### To-dos

- [ ] Build unified CFBD client wrapper with auth, throttling, retries
- [ ] Update requirements with missing runtime/dev deps
- [ ] Implement dataset fetch functions w/ schema validation
- [ ] Write regression tests for client and datasets
- [ ] Document CFBD run-book with escalation steps